import{g as K,r as o,j as e,B as C}from"./index-0519004f.js";import{I as p}from"./input-6347b997.js";import{D as X,a as _,b as M,c as G}from"./dropdown-menu-547329f2.js";import{D as V,a as Z,b as Y,c as R,d as ee,e as re,f as ae}from"./dialog-4db32c82.js";import{A as se,a as te,b as oe,c as ne,d as de,e as le,f as ce,g as ie}from"./alert-dialog-b233b391.js";import{L as u}from"./label-b5056dbc.js";import{D as me}from"./date-picker-8d155e3e.js";import{S as H}from"./save-97b13871.js";import{C as ue,a as pe,b as xe,c as he}from"./card-45b8ba19.js";import{U as ge}from"./user-ee9f9899.js";import{P as be}from"./plus-circle-caeaf085.js";import{S as Ne}from"./search-48aa1418.js";import{P as je}from"./pen-square-097b1a3d.js";import{T as fe}from"./trash-2-a5aed1ab.js";import{A as ke}from"./arrow-up-down-7e861127.js";import"./index-90ed1f01.js";import"./check-faf00884.js";const Ce=({onSave:m,onCancel:x,initialData:t,isEditMode:s})=>{const{toast:h}=K(),[n,b]=o.useState(""),[v,f]=o.useState(""),[k,y]=o.useState(""),[$,N]=o.useState(""),[g,S]=o.useState(""),[D,F]=o.useState(""),[L,A]=o.useState(""),[P,B]=o.useState(""),[T,O]=o.useState(""),[j,w]=o.useState(""),[r,d]=o.useState(""),[i,l]=o.useState(void 0),[c,U]=o.useState(null);o.useEffect(()=>{var a;s&&t?(b(t.name||""),f(t.displayName||""),y(t.proprietorName||""),N(t.customerNumber||""),S(t.phoneNumber||""),F(t.address||""),A(t.nid||""),B(t.extraField1||""),O(t.extraField2||""),w(t.extraField3||""),d(((a=t.openingBalance)==null?void 0:a.toString())||""),l(t.openingBalanceDate?new Date(t.openingBalanceDate):void 0),U(t.id||t.customerNumber)):q()},[t,s]);const q=()=>{b(""),f(""),y(""),N(""),S(""),F(""),A(""),B(""),O(""),w(""),d(""),l(void 0),U(null)},E=(a,Q=!0)=>{if(a.preventDefault(),!n){h({title:"Validation Error",description:"Customer Name is required.",variant:"destructive"});return}const W={id:c||`cust-${Date.now()}`,name:n,displayName:v,proprietorName:k,customerNumber:$||(c?c.split("-")[1]||String(Date.now()).slice(-4):`C${String(Date.now()).slice(-4)}`),phoneNumber:g,address:D,nid:L,extraField1:P,extraField2:T,extraField3:j,openingBalance:parseFloat(r)||0,openingBalanceDate:i?i.toISOString().split("T")[0]:null};m(W,s),h({title:`Customer ${s?"Updated":"Saved"}!`,description:`${n} has been successfully ${s?"updated":"added"}.`}),Q?x():s||q()};return e.jsxs("form",{onSubmit:a=>E(a,!0),className:"space-y-4 py-2",children:[e.jsxs(V,{className:"hidden",children:[e.jsx(Z,{children:s?"Edit Customer":"Add New Customer"}),e.jsx(Y,{children:s?"Update customer details.":"Fill in the details to add a new customer."})]}),e.jsxs("div",{children:[e.jsxs(u,{htmlFor:"customerName",children:["Customer Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{id:"customerName",value:n,onChange:a=>b(a.target.value),placeholder:"e.g., Client Omega Corp.",className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"displayName",children:"Display Name"}),e.jsx(p,{id:"displayName",value:v,onChange:a=>f(a.target.value),placeholder:"e.g., Omega Corp.",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"proprietorName",children:"Proprietor Name"}),e.jsx(p,{id:"proprietorName",value:k,onChange:a=>y(a.target.value),placeholder:"e.g., Jane Smith",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"customerNumber",children:"Customer Number"}),e.jsx(p,{id:"customerNumber",value:$,onChange:a=>N(a.target.value),placeholder:"e.g., C001",className:"mt-1",disabled:s}),s&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Customer number cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(p,{id:"phoneNumber",value:g,onChange:a=>S(a.target.value),placeholder:"e.g., +1234567890",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"address",children:"Address"}),e.jsx(p,{id:"address",value:D,onChange:a=>F(a.target.value),placeholder:"e.g., 456 Client Ave",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"nid",children:"NID"}),e.jsx(p,{id:"nid",value:L,onChange:a=>A(a.target.value),placeholder:"e.g., 1234567890",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"extraField1",children:"Extra Field 1"}),e.jsx(p,{id:"extraField1",value:P,onChange:a=>B(a.target.value),placeholder:"",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"extraField2",children:"Extra Field 2"}),e.jsx(p,{id:"extraField2",value:T,onChange:a=>O(a.target.value),placeholder:"",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"extraField3",children:"Extra Field 3"}),e.jsx(p,{id:"extraField3",value:j,onChange:a=>w(a.target.value),placeholder:"",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"openingBalance",children:"Opening Balance"}),e.jsx(p,{id:"openingBalance",type:"number",value:r,onChange:a=>d(a.target.value),placeholder:"0.00",className:"mt-1",disabled:s}),s&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"openingBalanceDate",children:"Opening Balance As of Date"}),e.jsx(me,{date:i,setDate:l,className:"mt-1 w-full",disabled:s}),s&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance date cannot be changed after creation."})]}),e.jsxs(R,{className:"pt-6",children:[e.jsx(ee,{asChild:!0,children:e.jsx(C,{variant:"outline",onClick:x,children:"Cancel"})}),!s&&e.jsxs(C,{type:"button",onClick:a=>E(a,!1),variant:"secondary",children:[e.jsx(H,{size:18,className:"mr-2"})," Save & New"]}),e.jsxs(C,{type:"submit",children:[e.jsx(H,{size:18,className:"mr-2"})," ",s?"Update Customer":"Save & Close"]})]})]})},J=[{id:"cust-001",name:"Client Omega Corp.",displayName:"Omega Corp.",proprietorName:"Mr. O",customerNumber:"C001",address:"123 Omega St",balance:2800,openingBalance:2800,openingBalanceDate:"2023-01-01"},{id:"cust-002",name:"Customer Zeta Ltd.",displayName:"Zeta Ltd.",proprietorName:"Ms. Z",customerNumber:"C002",address:"456 Zeta Ave",balance:0,openingBalance:0,openingBalanceDate:"2023-01-01"},{id:"cust-003",name:"Patron Gamma Solutions",displayName:"Gamma Solutions",proprietorName:"Dr. G",customerNumber:"C003",address:"789 Gamma Rd",balance:5120.75,openingBalance:5120.75,openingBalanceDate:"2023-01-01"},{id:"cust-004",name:"Client Alpha Services",displayName:"Alpha Services",proprietorName:"Prof. A",customerNumber:"C004",address:"012 Alpha Blvd",balance:-300,openingBalance:-300,openingBalanceDate:"2023-01-01"}],z=m=>({...m,balanceFormatted:(m.balance||0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),I=({children:m,columnKey:x,sortConfig:t,requestSort:s,isTextRight:h=!1,className:n=""})=>{const b=t&&t.key===x,v=b?t.direction:null;return e.jsx("th",{scope:"col",className:`px-4 py-3 cursor-pointer hover:bg-primary/10 dark:hover:bg-dark-primary/10 transition-colors ${h?"text-right":"text-left"} ${n}`,onClick:()=>s(x),children:e.jsxs("div",{className:`flex items-center ${h?"justify-end":"justify-start"}`,children:[!h&&m,e.jsx("span",{className:`mx-1 ${h?"mr-0 ml-1":"ml-0 mr-1"}`,children:b?v==="ascending"?"▲":"▼":e.jsx(ke,{size:14,className:"opacity-40"})}),h&&m]})})},Ee=()=>{const{toast:m}=K(),[x,t]=o.useState(()=>J.map(z)),[s,h]=o.useState(""),[n,b]=o.useState({key:"name",direction:"ascending"}),[v,f]=o.useState(!1),[k,y]=o.useState(null),[$,N]=o.useState(!1),[g,S]=o.useState(null);o.useEffect(()=>{const r=localStorage.getItem("customers");r?t(JSON.parse(r).map(z)):localStorage.setItem("customers",JSON.stringify(J))},[]);const D=r=>{localStorage.setItem("customers",JSON.stringify(r.map(({balanceFormatted:d,...i})=>i)))},F=(r=null)=>{y(r),f(!0)},L=()=>{f(!1),y(null)},A=(r,d)=>{t(i=>{let l;if(d)l=i.map(c=>c.id===r.id?z({...c,...r,balance:r.openingBalance}):c);else{const c=z({...r,balance:r.openingBalance});l=[...i,c]}return D(l),l})},P=r=>{const d=x.find(i=>i.id===r);d&&(S(d),N(!0))},B=()=>{if(g){const r=x.filter(d=>d.id!==g.id);t(r),D(r),m({title:"Customer Deleted",description:`${g.name} has been deleted.`,variant:"destructive"}),N(!1),S(null)}},T=()=>{m({title:"Import Customers from Excel",description:"This feature will be available soon.",duration:3e3})},O=r=>h(r.target.value),j=r=>{let d="ascending";n&&n.key===r&&n.direction==="ascending"&&(d="descending"),b({key:r,direction:d})},w=o.useMemo(()=>{let r=[...x];if(s){const d=s.toLowerCase();r=r.filter(i=>{var l;return Object.values(i).some(c=>String(c).toLowerCase().includes(d))||((l=i.displayName)==null?void 0:l.toLowerCase().includes(d))})}return n!==null&&r.sort((d,i)=>{let l=d[n.key],c=i[n.key];return n.key==="balance"?(l=parseFloat(l)||0,c=parseFloat(c)||0):typeof l=="string"&&(l=l.toLowerCase(),c=c.toLowerCase()),l<c?n.direction==="ascending"?-1:1:l>c?n.direction==="ascending"?1:-1:0}),r},[s,n,x]);return e.jsx("div",{className:"space-y-6 p-1",children:e.jsxs(ue,{className:"shadow-lg border-border dark:border-dark-border",children:[e.jsx(pe,{className:"bg-card dark:bg-dark-card rounded-t-lg p-4 md:p-6 border-b border-border dark:border-dark-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsxs(xe,{className:"text-2xl md:text-3xl font-bold text-primary dark:text-dark-primary flex items-center",children:[e.jsx(ge,{size:28,className:"mr-3 text-accent dark:text-dark-accent"})," Customer Center"]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(X,{children:[e.jsx(_,{asChild:!0,children:e.jsxs(C,{variant:"outline",className:"text-primary dark:text-dark-primary border-primary dark:border-dark-primary hover:bg-primary/10 dark:hover:bg-dark-primary/10 shadow-sm",children:[e.jsx(be,{size:20,className:"mr-2"})," Add Customer"]})}),e.jsxs(M,{align:"end",className:"bg-card dark:bg-dark-card shadow-lg rounded-md border border-border dark:border-dark-border",children:[e.jsx(G,{onClick:()=>F(null),className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Add New"}),e.jsx(G,{onClick:T,className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Import from Excel"})]})]})})]})}),e.jsxs(he,{className:"p-4 md:p-6",children:[e.jsx(re,{open:v,onOpenChange:f,children:e.jsxs(ae,{className:"sm:max-w-[550px] bg-card dark:bg-dark-card text-foreground dark:text-dark-foreground border-border dark:border-dark-border shadow-2xl rounded-lg",children:[e.jsxs(V,{children:[e.jsx(Z,{className:"text-primary dark:text-dark-primary text-2xl font-semibold",children:k?"Edit Customer":"Add New Customer"}),e.jsx(Y,{className:"text-muted-foreground dark:text-dark-muted-foreground",children:k?"Update customer details.":"Fill in the details to add a new customer."})]}),e.jsx(Ce,{onSave:A,onCancel:L,initialData:k,isEditMode:!!k})]})}),e.jsx(se,{open:$,onOpenChange:N,children:e.jsxs(te,{children:[e.jsxs(oe,{children:[e.jsx(ne,{children:"Are you absolutely sure?"}),e.jsxs(de,{children:['This action cannot be undone. This will permanently delete the customer "',g==null?void 0:g.name,'".']})]}),e.jsxs(le,{children:[e.jsx(ce,{onClick:()=>N(!1),children:"Cancel"}),e.jsx(ie,{onClick:B,className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete customer"})]})]})}),e.jsxs("div",{className:"mb-6 flex items-center space-x-2 p-3 bg-background dark:bg-dark-background rounded-lg shadow-sm border border-border dark:border-dark-border",children:[e.jsx(p,{type:"text",placeholder:"Search customers (Name, Balance...)",className:"flex-grow focus:ring-accent dark:focus:ring-dark-accent border-input dark:border-dark-input focus:border-primary dark:focus:border-dark-primary",value:s,onChange:O}),e.jsxs(C,{className:"bg-primary text-primary-foreground hover:bg-primary-hover dark:bg-dark-primary dark:text-dark-primary-foreground dark:hover:bg-dark-primary-hover",onClick:()=>m({title:"Search Updated",description:`Displaying results for "${s}"`}),children:[e.jsx(Ne,{size:18,className:"mr-2"})," Search"]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border dark:border-dark-border shadow-md",children:e.jsxs("table",{className:"w-full min-w-[600px] text-sm text-left text-foreground dark:text-dark-foreground",children:[e.jsx("thead",{className:"text-xs text-primary dark:text-dark-primary uppercase bg-muted/50 dark:bg-dark-muted/50",children:e.jsxs("tr",{children:[e.jsx(I,{columnKey:"name",sortConfig:n,requestSort:j,className:"min-w-[150px]",children:"Customer Name"}),e.jsx(I,{columnKey:"displayName",sortConfig:n,requestSort:j,className:"min-w-[150px]",children:"Display Name"}),e.jsx(I,{columnKey:"address",sortConfig:n,requestSort:j,children:"Address"}),e.jsx(I,{columnKey:"phoneNumber",sortConfig:n,requestSort:j,children:"Phone Number"}),e.jsx(I,{columnKey:"balance",sortConfig:n,requestSort:j,isTextRight:!0,children:"Balance"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center w-28",children:"Actions"})]})}),e.jsxs("tbody",{children:[w.map(r=>e.jsxs("tr",{className:"bg-card dark:bg-dark-card border-b border-border dark:border-dark-border last:border-b-0 hover:bg-muted/30 dark:hover:bg-dark-muted/30 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-secondary dark:text-dark-secondary hover:underline cursor-pointer",onClick:()=>m({title:`View Ledger: ${r.name}`,description:"Detailed customer ledger view coming soon."}),children:r.name}),e.jsx("td",{className:"px-4 py-3",children:r.displayName}),e.jsx("td",{className:"px-4 py-3",children:r.address}),e.jsx("td",{className:"px-4 py-3",children:r.phoneNumber}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold",children:r.balanceFormatted}),e.jsxs("td",{className:"px-4 py-3 text-center space-x-1",children:[e.jsx(C,{variant:"ghost",size:"icon",className:"text-secondary dark:text-dark-secondary hover:text-accent dark:hover:text-dark-accent h-8 w-8",onClick:()=>F(r),children:e.jsx(je,{size:16})}),e.jsx(C,{variant:"ghost",size:"icon",className:"text-destructive dark:text-red-400 hover:text-destructive/80 dark:hover:text-red-300 h-8 w-8",onClick:()=>P(r.id),children:e.jsx(fe,{size:16})})]})]},r.id)),w.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-10 text-muted-foreground dark:text-dark-muted-foreground",children:s?`No customers found for "${s}".`:"No customers found. Start by adding a customer!"})})]})]})})]})]})})};export{Ee as default};
