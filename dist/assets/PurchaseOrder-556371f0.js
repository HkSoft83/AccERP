import{g as $,i as q,r as o,j as e,I as J,B as n,K as R}from"./index-b7aea214.js";import{e as L,f as K,D as Q,a as Y,b as G}from"./dialog-62b5c37e.js";import{A as W,a as X,b as Z,c as _,d as ee,e as re}from"./alert-dialog-e7ac14aa.js";import{A as te}from"./AddPurchaseOrderForm-1a184b3f.js";import{C as se,a as de,b as ae,c as oe}from"./card-88acce12.js";import{T as C,a as S,b as l,c as d,d as w,e as s}from"./table-e4d99766.js";import{P as ne}from"./plus-circle-50bca9da.js";import{E as ie}from"./eye-7f99ff86.js";import{P as le}from"./pen-square-1ffd1c3f.js";import{T as ce}from"./trash-2-898e334b.js";import{f as j}from"./date-picker-09e5b332.js";import"./input-84ae9c17.js";import"./label-d3565414.js";import"./select-844d03e2.js";import"./check-fa87f2d0.js";import"./textarea-4d8431b6.js";import"./package-plus-608ee273.js";import"./save-ccda8c50.js";const Ae=()=>{var O,v;const{toast:k}=$(),A=q(),[T,x]=o.useState(!1),[u,m]=o.useState([]),[p,P]=o.useState([]),[t,b]=o.useState(null),[h,N]=o.useState(null),[i,y]=o.useState(null),[M,c]=o.useState(!1);o.useEffect(()=>{const r=JSON.parse(localStorage.getItem("purchaseOrders")||"[]");m(r);const a=JSON.parse(localStorage.getItem("vendors")||"[]");P(a)},[]);const I=()=>{x(!0)},g=()=>{x(!1)},z=()=>{const r=JSON.parse(localStorage.getItem("purchaseOrders")||"[]");m(r),g()},E=r=>{b(r)},B=r=>{N(r),x(!0)},F=r=>{y(r),c(!0)},U=()=>{if(i){const r=u.filter(a=>a.orderNumber!==i.orderNumber);localStorage.setItem("purchaseOrders",JSON.stringify(r)),m(r),k({title:"Order Deleted",description:`Purchase Order ${i.orderNumber} has been deleted.`,variant:"destructive"}),c(!1),y(null)}},H=r=>{A("/purchase/bill",{state:{purchaseOrder:r}}),k({title:"Converting to Bill",description:`Redirecting to Purchase Bill for Order ${r.orderNumber}.`})};return e.jsx("div",{className:"space-y-6",children:e.jsxs(se,{className:"shadow-lg border-border dark:border-dark-border",children:[e.jsx(de,{className:"bg-card dark:bg-dark-card rounded-t-lg p-4 md:p-6 border-b border-border dark:border-dark-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsxs(ae,{className:"text-2xl md:text-3xl font-bold text-primary dark:text-dark-primary flex items-center",children:[e.jsx(J,{size:28,className:"mr-3 text-accent dark:text-dark-accent"})," Purchase Orders"]}),e.jsxs(n,{className:"bg-primary text-primary-foreground hover:bg-primary-hover dark:bg-dark-primary dark:text-dark-primary-foreground dark:hover:bg-dark-primary-hover shadow-sm",onClick:I,children:[e.jsx(ne,{size:20,className:"mr-2"})," Create Purchase Order"]})]})}),e.jsxs(oe,{className:"p-4 md:p-6",children:[e.jsx(L,{open:T||!!t,onOpenChange:r=>{r||(g(),b(null),N(null))},children:e.jsxs(K,{className:"sm:max-w-[1200px] h-[90vh] bg-card dark:bg-dark-card text-foreground dark:text-dark-foreground border-border dark:border-dark-border shadow-2xl rounded-lg",children:[e.jsxs(Q,{children:[e.jsx(Y,{className:"text-primary dark:text-dark-primary text-2xl font-semibold",children:t?"Purchase Order Details":h?"Edit Purchase Order":"Create New Purchase Order"}),e.jsx(G,{className:"text-muted-foreground dark:text-dark-muted-foreground",children:t?"Details of the selected purchase order.":h?"Edit the details of the purchase order.":"Fill in the details to create a new purchase order."})]}),t?e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Order Number:"})," ",t.orderNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Supplier:"})," ",((O=p.find(r=>r.id===t.vendor))==null?void 0:O.name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Order Date:"})," ",j(new Date(t.orderDate),"dd-MMM-yyyy")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expected Delivery Date:"})," ",j(new Date(t.expectedDeliveryDate),"dd-MMM-yyyy")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Memo:"})," ",t.memo||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Shipping Address:"})," ",t.shippingAddress||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Drop Ship To:"})," ",t.dropShipToCustomer&&((v=p.find(r=>r.id===t.dropShipToCustomer))==null?void 0:v.name)||"N/A"]}),e.jsx("h4",{className:"font-semibold mt-4",children:"Line Items:"}),e.jsxs(C,{children:[e.jsx(S,{children:e.jsxs(l,{children:[e.jsx(d,{children:"Product"}),e.jsx(d,{children:"Quantity"}),e.jsx(d,{children:"Rate"}),e.jsx(d,{children:"Discount"})]})}),e.jsx(w,{children:t.lineItems.map((r,a)=>e.jsxs(l,{children:[e.jsx(s,{children:r.productName}),e.jsxs(s,{children:[r.quantityInput," ",r.quantityUnitName]}),e.jsxs(s,{children:[r.rateForBillingUnit," per ",r.billingUnitName]}),e.jsx(s,{children:r.discountPercent>0?`${r.discountPercent}%`:r.discountAmount>0?`${r.discountAmount}`:"N/A"})]},a))})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Notes:"})," ",t.notes||"N/A"]})]}):e.jsx(te,{onSave:z,onCancel:g,initialData:h})]})}),e.jsx(W,{open:M,onOpenChange:c,children:e.jsxs(X,{children:[e.jsxs(Z,{children:[e.jsx(_,{children:"Are you absolutely sure?"}),e.jsxs(ee,{children:['This action cannot be undone. This will permanently delete the purchase order "',i==null?void 0:i.orderNumber,'".']})]}),e.jsxs(re,{children:[e.jsx(n,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:U,children:"Yes, delete order"})]})]})}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border dark:border-dark-border shadow-md",children:e.jsxs(C,{className:"min-w-[800px]",children:[e.jsx(S,{className:"bg-muted/50 dark:bg-dark-muted/50",children:e.jsxs(l,{children:[e.jsx(d,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Supplier"}),e.jsx(d,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Order No."}),e.jsx(d,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Order Date"}),e.jsx(d,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Memo"}),e.jsx(d,{className:"px-4 py-3 text-right text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Total Amount"}),e.jsx(d,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Status"}),e.jsx(d,{className:"px-4 py-3 text-center text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Action"})]})}),e.jsx(w,{className:"bg-card dark:bg-dark-card divide-y divide-border dark:divide-dark-border",children:u.length>0?u.map(r=>{const a=p.find(f=>f.id===r.vendor),V=r.lineItems.reduce((f,D)=>f+D.rateForBillingUnit*D.quantityInput,0);return e.jsxs(l,{children:[e.jsx(s,{className:"px-4 py-3 font-medium text-foreground dark:text-dark-foreground",children:a?a.name:"N/A"}),e.jsx(s,{className:"px-4 py-3 text-muted-foreground dark:text-dark-muted-foreground",children:r.orderNumber}),e.jsx(s,{className:"px-4 py-3 text-muted-foreground dark:text-dark-muted-foreground",children:j(new Date(r.orderDate),"dd-MMM-yyyy")}),e.jsx(s,{className:"px-4 py-3 text-muted-foreground dark:text-dark-muted-foreground",children:r.memo||"-"}),e.jsx(s,{className:"px-4 py-3 text-right font-semibold text-foreground dark:text-dark-foreground",children:V.toLocaleString("en-US",{style:"currency",currency:"USD"})}),e.jsx(s,{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${r.isDraft?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:r.isDraft?"Draft":"Finalized"})}),e.jsxs(s,{className:"px-4 py-3 text-center space-x-2",children:[e.jsx(n,{variant:"ghost",size:"icon",className:"text-blue-600 hover:text-blue-800",onClick:()=>E(r),children:e.jsx(ie,{size:18})}),e.jsx(n,{variant:"ghost",size:"icon",className:"text-green-600 hover:text-green-800",onClick:()=>B(r),children:e.jsx(le,{size:18})}),e.jsx(n,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-800",onClick:()=>F(r),children:e.jsx(ce,{size:18})}),e.jsx(n,{variant:"ghost",size:"icon",className:"text-purple-600 hover:text-purple-800",onClick:()=>H(r),title:"Convert to Bill",children:e.jsx(R,{size:18})})]})]},r.orderNumber)}):e.jsx(l,{children:e.jsx(s,{colSpan:7,className:"h-24 text-center text-muted-foreground dark:text-dark-muted-foreground",children:'No purchase orders found. Click "Create Purchase Order" to add one.'})})})]})})]})]})})};export{Ae as default};
