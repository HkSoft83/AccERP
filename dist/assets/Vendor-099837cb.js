import{c as _e,g as Se,r as t,j as e,B as k,S as Ge,i as Ke}from"./index-0519004f.js";import{I as C}from"./input-6347b997.js";import{D as Ye,a as Qe,b as Xe,c as De}from"./dropdown-menu-547329f2.js";import{e as ae,g as We,f as ne,D as de,a as oe,b as le,c as be,d as we}from"./dialog-4db32c82.js";import{A as Te,a as Ae,b as Ve,c as Be,d as Pe,e as Ie,f as Ze,g as er}from"./alert-dialog-b233b391.js";import{L as y}from"./label-b5056dbc.js";import{D as Ne,f as ee}from"./date-picker-8d155e3e.js";import{S as rr,a as sr,b as tr,c as ar,d as nr}from"./select-fc98f503.js";import{T as ke}from"./textarea-ae6cb620.js";import{S as Oe}from"./save-97b13871.js";import{C as Me,c as Ee,a as dr,b as or}from"./card-45b8ba19.js";import{T as ue,a as he,b as L,c as N,d as xe,e as u}from"./table-696e7d05.js";import{T as lr,a as ir,b as pe,c as ge}from"./tabs-be40c47b.js";import{E as cr,A as mr}from"./AddPurchaseOrderForm-a36ae495.js";import{p as W,F as ur}from"./parseISO-5252f824.js";import{S as Le}from"./search-48aa1418.js";import{P as ve}from"./pen-square-097b1a3d.js";import{T as ye}from"./trash-2-a5aed1ab.js";import{P as ze}from"./plus-circle-caeaf085.js";import{A as hr}from"./arrow-up-down-7e861127.js";import"./index-90ed1f01.js";import"./check-faf00884.js";import"./package-plus-9fc79988.js";const xr=_e("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),pr=({onSave:d,onCancel:O,initialData:o,isEditMode:h})=>{const{toast:S}=Se(),[x,z]=t.useState(""),[D,R]=t.useState(""),[F,H]=t.useState(""),[U,A]=t.useState(""),[w,q]=t.useState(""),[l,K]=t.useState(""),[V,B]=t.useState(""),[Z,P]=t.useState(""),[v,_]=t.useState(""),[G,I]=t.useState(""),[Y,$]=t.useState(""),[T,M]=t.useState(""),[a,g]=t.useState(void 0),[c,f]=t.useState(null);t.useState(!1);const[p,J]=t.useState([{name:"Custom Field 1",value:"",options:""},{name:"Custom Field 2",value:"",options:""},{name:"Custom Field 3",value:"",options:""}]),Q=(s,b)=>{const j=[...p];j[s].name=b,J(j)},ie=(s,b)=>{const j=[...p];j[s].options=b,J(j)},ce=(s,b)=>{const j=[...p];j[s].value=b,J(j)};t.useEffect(()=>{var s;h&&o?(z(o.name||""),R(o.displayName||""),H(o.proprietorName||""),A(o.vendorNumber||""),q(o.phoneNumber||""),K(o.address||""),B(o.nid||""),P(o.email||""),_(o.bankDetails||""),I(o.creditLimit||""),$(o.notes||""),M(((s=o.openingBalance)==null?void 0:s.toString())||""),g(o.openingBalanceDate?new Date(o.openingBalanceDate):void 0),f(o.id||o.vendorNumber),o.customFields&&J(o.customFields)):X()},[o,h]);const X=()=>{z(""),R(""),H(""),A(""),q(""),K(""),B(""),P(""),_(""),I(""),$(""),M(""),g(void 0),f(null),J([{name:"Custom Field 1",value:"",options:""},{name:"Custom Field 2",value:"",options:""},{name:"Custom Field 3",value:"",options:""}])},me=(s,b=!0)=>{if(s.preventDefault(),!x){S({title:"Validation Error",description:"Vendor Name is required.",variant:"destructive"});return}const j={id:c||`vend-${Date.now()}`,name:x,displayName:D,proprietorName:F,vendorNumber:U||(c?c.split("-")[1]||String(Date.now()).slice(-4):`V${String(Date.now()).slice(-4)}`),phoneNumber:w,address:l,nid:V,email:Z,bankDetails:v,creditLimit:G,notes:Y,openingBalance:parseFloat(T)||0,openingBalanceDate:a?a.toISOString().split("T")[0]:null,customFields:p};d(j,h),S({title:`Vendor ${h?"Updated":"Saved"}!`,description:`${x} has been successfully ${h?"updated":"added"}.`}),b?O():h||X()};return e.jsxs("form",{onSubmit:s=>me(s,!0),className:"space-y-4 py-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(ae,{children:[e.jsx(We,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",children:e.jsx(Ge,{className:"h-5 w-5"})})}),e.jsxs(ne,{children:[e.jsxs(de,{children:[e.jsx(oe,{children:"Customize Fields"}),e.jsx(le,{children:"Define the labels and options for your custom fields."})]}),e.jsx("div",{className:"space-y-4 py-4",children:p.map((s,b)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{children:["Field ",b+1," Name"]}),e.jsx(C,{value:s.name,onChange:j=>Q(b,j.target.value)}),e.jsxs(y,{children:["Field ",b+1," Options (comma-separated)"]}),e.jsx(C,{value:s.options,onChange:j=>ie(b,j.target.value),placeholder:"e.g., Option 1, Option 2"})]},b))}),e.jsx(be,{children:e.jsx(we,{asChild:!0,children:e.jsx(k,{children:"Done"})})})]})]})}),e.jsxs("div",{children:[e.jsxs(y,{htmlFor:"vendorName",children:["Vendor Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{id:"vendorName",value:x,onChange:s=>z(s.target.value),placeholder:"e.g., Supplier Alpha Inc.",className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"displayName",children:"Display Name"}),e.jsx(C,{id:"displayName",value:D,onChange:s=>R(s.target.value),placeholder:"e.g., Alpha Inc.",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"proprietorName",children:"Proprietor Name"}),e.jsx(C,{id:"proprietorName",value:F,onChange:s=>H(s.target.value),placeholder:"e.g., John Doe",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"vendorNumber",children:"Vendor Number"}),e.jsx(C,{id:"vendorNumber",value:U,onChange:s=>A(s.target.value),placeholder:"e.g., V001",className:"mt-1",disabled:h}),h&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vendor number cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(C,{id:"phoneNumber",value:w,onChange:s=>q(s.target.value),placeholder:"e.g., +1234567890",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"address",children:"Address"}),e.jsx(C,{id:"address",value:l,onChange:s=>K(s.target.value),placeholder:"e.g., 123 Supply Chain Rd",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"nid",children:"NID"}),e.jsx(C,{id:"nid",value:V,onChange:s=>B(s.target.value),placeholder:"e.g., 1234567890123",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"email",children:"Email"}),e.jsx(C,{id:"email",type:"email",value:Z,onChange:s=>P(s.target.value),placeholder:"e.g., john.doe@example.com",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"bankDetails",children:"Bank Details"}),e.jsx(ke,{id:"bankDetails",value:v,onChange:s=>_(s.target.value),placeholder:"e.g., Bank Name, Account Number, IFSC Code",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"creditLimit",children:"Credit Limit"}),e.jsx(C,{id:"creditLimit",type:"number",value:G,onChange:s=>I(s.target.value),placeholder:"e.g., 5000",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"notes",children:"Notes"}),e.jsx(ke,{id:"notes",value:Y,onChange:s=>$(s.target.value),placeholder:"e.g., Any additional notes about the vendor",className:"mt-1"})]}),p.map((s,b)=>e.jsxs("div",{children:[e.jsx(y,{htmlFor:`custom-field-${b}`,children:s.name}),s.options?e.jsxs(rr,{onValueChange:j=>ce(b,j),value:s.value,children:[e.jsx(sr,{className:"mt-1",children:e.jsx(tr,{placeholder:`Select ${s.name}`})}),e.jsx(ar,{children:s.options.split(",").map((j,fe)=>e.jsx(nr,{value:j.trim(),children:j.trim()},fe))})]}):e.jsx(C,{id:`custom-field-${b}`,value:s.value,onChange:j=>ce(b,j.target.value),placeholder:`Enter ${s.name}`,className:"mt-1"})]},b)),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"openingBalance",children:"Opening Balance"}),e.jsx(C,{id:"openingBalance",type:"number",value:T,onChange:s=>M(s.target.value),placeholder:"0.00",className:"mt-1",disabled:h}),h&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance cannot be changed after creation."})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"openingBalanceDate",children:"Opening Balance As of Date"}),e.jsx(Ne,{date:a,setDate:g,className:"mt-1 w-full",disabled:h}),h&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opening balance date cannot be changed after creation."})]}),e.jsxs(be,{className:"pt-6",children:[e.jsx(we,{asChild:!0,children:e.jsx(k,{variant:"outline",onClick:O,children:"Cancel"})}),!h&&e.jsxs(k,{type:"button",onClick:s=>me(s,!1),variant:"secondary",children:[e.jsx(Oe,{size:18,className:"mr-2"})," Save & New"]}),e.jsxs(k,{type:"submit",children:[e.jsx(Oe,{size:18,className:"mr-2"})," ",h?"Update Vendor":"Save & Close"]})]})]})},gr=({vendorId:d,vendorName:O,onClose:o,onEditVendor:h})=>{const{toast:S}=Se(),[x,z]=t.useState([]),[D,R]=t.useState([]),[F,H]=t.useState(null),[U,A]=t.useState(null),[w,q]=t.useState(""),[l,K]=t.useState(null),[V,B]=t.useState([]),[Z,P]=t.useState(!1),[v,_]=t.useState(null),[G,I]=t.useState(""),[Y,$]=t.useState(""),[T,M]=t.useState(null),[a,g]=t.useState([]),[c,f]=t.useState(null),[p,J]=t.useState(null),[Q,ie]=t.useState(null),[ce,X]=t.useState(!1),[me,s]=t.useState(!1);t.useEffect(()=>{if(v)I(v.title||""),$(v.description||""),M(v.reminderTime?W(v.reminderTime):null);else{I(""),$("");const r=new Date;r.setHours(10,0,0,0),M(r)}},[v]),t.useEffect(()=>{if(d){const r=JSON.parse(localStorage.getItem(`vendor_${d}_notes`))||[];B(r)}},[d]);const b=()=>{if(!G||!Y){S({title:"Error",description:"Title and Description are required for a note.",variant:"destructive"});return}const r={id:v?v.id:`note-${Date.now()}`,title:G,description:Y,reminderTime:T?T.toISOString():null,creationDate:v?v.creationDate:new Date().toISOString()};let n;v?(n=V.map(m=>m.id===r.id?r:m),S({title:"Success",description:"Note updated successfully."})):(n=[...V,r],S({title:"Success",description:"Note added successfully."})),localStorage.setItem(`vendor_${d}_notes`,JSON.stringify(n)),B(n),P(!1),_(null),I(""),$(""),M(null)},j=r=>{_(r),P(!0)},fe=r=>{const n=V.filter(m=>m.id!==r);localStorage.setItem(`vendor_${d}_notes`,JSON.stringify(n)),B(n),S({title:"Success",description:"Note deleted successfully."})},$e=r=>{f(r),X(!0)},Je=r=>{J(r),X(!0)},Re=r=>{ie(r),s(!0)},He=()=>{if(Q){const n=JSON.parse(localStorage.getItem("purchaseOrders")||"[]").filter(m=>m.orderNumber!==Q.orderNumber);localStorage.setItem("purchaseOrders",JSON.stringify(n)),g(n.filter(m=>m.vendor===d)),S({title:"Order Deleted",description:`Purchase Order ${Q.orderNumber} has been deleted.`,variant:"destructive"}),s(!1),ie(null)}},Ue=()=>{const n=JSON.parse(localStorage.getItem("purchaseOrders")||"[]").filter(m=>m.vendor===d);g(n),X(!1),J(null),f(null)};t.useEffect(()=>{const n=(JSON.parse(localStorage.getItem("vendors"))||[]).find(m=>m.id===d);K(n)},[d]),t.useEffect(()=>{if(!d)return;const r=JSON.parse(localStorage.getItem("purchaseBills"))||[],n=JSON.parse(localStorage.getItem("payments"))||[],m=JSON.parse(localStorage.getItem("purchaseReturns"))||[],re=JSON.parse(localStorage.getItem("debitNotes"))||[],E=[];r.filter(i=>i.vendorId===d).forEach(i=>{var se;return E.push({date:W(i.billDate),type:"Purchase Bill",ref:i.billNumber,narration:`Bill for ${((se=i.lineItems)==null?void 0:se.length)||0} items`,debit:0,credit:parseFloat(i.grandTotal)||0})}),n.filter(i=>i.paidTo===d).forEach(i=>E.push({date:W(i.date),type:"Payment",ref:i.paymentNumber,narration:i.narration||"Payment made",debit:parseFloat(i.amount)||0,credit:0})),m.filter(i=>i.vendorId===d).forEach(i=>{var se;return E.push({date:W(i.returnDate),type:"Purchase Return",ref:i.returnNumber,narration:`Return of ${((se=i.lineItems)==null?void 0:se.length)||0} items`,debit:parseFloat(i.grandTotal)||0,credit:0})}),re.filter(i=>i.creditAccount===d).forEach(i=>E.push({date:W(i.date),type:"Debit Note",ref:i.debitNoteNumber,narration:i.narration||"Debit issued",debit:parseFloat(i.amount)||0,credit:0})),z(E)},[d]);const Ce=t.useMemo(()=>{if(!l)return[];let r=l.openingBalance;const n=l.openingBalanceDate?W(l.openingBalanceDate):new Date(new Date().getFullYear(),0,1),m=[];return m.push({date:n,type:"Opening Balance",ref:"-",narration:"Opening Balance",debit:l.openingBalance<0?Math.abs(l.openingBalance):0,credit:l.openingBalance>=0?l.openingBalance:0,balance:r}),[...x].sort((E,i)=>E.date-i.date).forEach(E=>{r+=(E.credit||0)-(E.debit||0),m.push({...E,balance:r})}),m},[x,l]);t.useEffect(()=>{let r=Ce;if(F&&(r=r.filter(n=>n.date>=F)),U&&(r=r.filter(n=>n.date<=U)),w){const n=w.toLowerCase();r=r.filter(m=>m.type.toLowerCase().includes(n)||m.ref.toLowerCase().includes(n)||m.narration.toLowerCase().includes(n))}R(r)},[Ce,F,U,w]);const qe=()=>{H(null),A(null),q("")};return t.useEffect(()=>{if(d){const n=(JSON.parse(localStorage.getItem("purchaseOrders"))||[]).filter(m=>m.vendor===d);g(n)}},[d]),e.jsx(Me,{className:"shadow-xl border-border dark:border-dark-border",children:e.jsxs(Ee,{className:"p-4 md:p-6 space-y-4",children:[l&&e.jsxs("div",{className:"relative p-3 bg-primary/5 dark:bg-dark-primary/10 rounded-md border border-primary/20 dark:border-dark-primary/20 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary dark:text-dark-primary",children:l.name}),e.jsxs("p",{className:"text-sm text-muted-foreground dark:text-dark-muted-foreground",children:["Vendor ID: ",l.vendorNumber||l.id]}),e.jsxs("p",{className:"text-sm text-muted-foreground dark:text-dark-muted-foreground",children:["Address: ",l.address||"N/A"]}),e.jsxs("p",{className:"text-sm text-muted-foreground dark:text-dark-muted-foreground",children:["Phone: ",l.phoneNumber||"N/A"," | Email: ",l.email||"N/A"]}),e.jsxs("p",{className:"text-sm text-muted-foreground dark:text-dark-muted-foreground",children:["Credit Limit: ",l.creditLimit?parseFloat(l.creditLimit).toLocaleString("en-US",{style:"currency",currency:"USD"}):"N/A"]}),e.jsxs("p",{className:"text-sm text-muted-foreground dark:text-dark-muted-foreground",children:["Bank Details: ",l.bankDetails||"N/A"]}),e.jsxs("p",{className:"text-sm text-muted-foreground dark:text-dark-muted-foreground mt-2",children:["Notes: ",l.notes||"N/A"]})]}),e.jsxs(lr,{defaultValue:"transactions",className:"w-full",children:[e.jsxs(ir,{className:"grid w-full grid-cols-4",children:[e.jsx(pe,{value:"transactions",children:"Transactions"}),e.jsx(pe,{value:"purchase-orders",children:"Purchase Orders"}),e.jsx(pe,{value:"notes",children:"Notes"}),e.jsx(pe,{value:"attachments",children:"Attachments"})]}),e.jsxs(ge,{value:"transactions",className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"startDate",className:"text-sm font-medium text-muted-foreground dark:text-dark-muted-foreground",children:"From Date"}),e.jsx(Ne,{date:F,setDate:H,id:"startDate",placeholder:"Start Date"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"endDate",className:"text-sm font-medium text-muted-foreground dark:text-dark-muted-foreground",children:"To Date"}),e.jsx(Ne,{date:U,setDate:A,id:"endDate",placeholder:"End Date"})]}),e.jsxs("div",{className:"relative flex-grow w-full sm:w-auto",children:[e.jsx(Le,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground dark:text-dark-muted-foreground"}),e.jsx(C,{type:"search",placeholder:"Search transactions...",value:w,onChange:r=>q(r.target.value),className:"pl-8 w-full"})]}),e.jsxs(k,{onClick:qe,variant:"outline",size:"sm",className:"w-full sm:w-auto",children:[e.jsx(ur,{size:16,className:"mr-2"})," Clear Filters"]})]}),e.jsx("div",{className:"overflow-x-auto border border-border dark:border-dark-border rounded-lg",children:e.jsxs(ue,{children:[e.jsx(he,{className:"bg-muted dark:bg-dark-muted",children:e.jsxs(L,{children:[e.jsx(N,{className:"w-[50px]",children:"Sl No"}),e.jsx(N,{className:"w-[100px]",children:"Date"}),e.jsx(N,{children:"Type / Ref#"}),e.jsx(N,{children:"Narration"}),e.jsx(N,{className:"text-right",children:"Debit"}),e.jsx(N,{className:"text-right",children:"Credit"}),e.jsx(N,{className:"text-right",children:"Balance"})]})}),e.jsx(xe,{children:D.length>0?D.map((r,n)=>e.jsxs(L,{className:"hover:bg-muted/50 dark:hover:bg-dark-muted/50",children:[e.jsx(u,{children:n+1}),e.jsx(u,{children:ee(r.date,"dd-MMM-yy")}),e.jsxs(u,{children:[e.jsx("div",{className:"font-medium",children:r.type}),e.jsx("div",{className:"text-xs text-muted-foreground dark:text-dark-muted-foreground",children:r.ref})]}),e.jsx(u,{children:r.narration}),e.jsx(u,{className:"text-right",children:(r.debit||0)>0?(r.debit||0).toFixed(2):"-"}),e.jsx(u,{className:"text-right",children:(r.credit||0)>0?(r.credit||0).toFixed(2):"-"}),e.jsx(u,{className:"text-right font-semibold",children:r.balance.toFixed(2)})]},n)):e.jsx(L,{children:e.jsx(u,{colSpan:6,className:"text-center h-24 text-muted-foreground dark:text-dark-muted-foreground",children:"No transactions found for this vendor."})})})]})}),D.length>0&&e.jsxs("div",{className:"flex justify-end pt-2 text-sm font-semibold text-primary dark:text-dark-primary",children:["Final Balance: ",D[D.length-1].balance.toFixed(2),D[D.length-1].balance>=0?" (Payable)":" (Receivable)"]}),")}"]}),e.jsxs(ge,{value:"purchase-orders",className:"space-y-4 pt-4",children:[e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border dark:border-dark-border shadow-md",children:e.jsxs(ue,{className:"min-w-[800px]",children:[e.jsx(he,{className:"bg-muted/50 dark:bg-dark-muted/50",children:e.jsxs(L,{children:[e.jsx(N,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Order No."}),e.jsx(N,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Order Date"}),e.jsx(N,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Memo"}),e.jsx(N,{className:"px-4 py-3 text-right text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Total Amount"}),e.jsx(N,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Status"}),e.jsx(N,{className:"px-4 py-3 text-center text-xs font-medium text-muted-foreground dark:text-dark-muted-foreground uppercase tracking-wider",children:"Action"})]})}),e.jsx(xe,{className:"bg-card dark:bg-dark-card divide-y divide-border dark:divide-dark-border",children:a.length>0?a.map(r=>{const n=r.lineItems.reduce((m,re)=>m+re.rateForBillingUnit*re.quantityInput,0);return e.jsxs(L,{children:[e.jsx(u,{className:"px-4 py-3 text-muted-foreground dark:text-dark-muted-foreground",children:r.orderNumber}),e.jsx(u,{className:"px-4 py-3 text-muted-foreground dark:text-dark-muted-foreground",children:ee(new Date(r.orderDate),"dd-MMM-yyyy")}),e.jsx(u,{className:"px-4 py-3 text-muted-foreground dark:text-dark-muted-foreground",children:r.memo||"-"}),e.jsx(u,{className:"px-4 py-3 text-right font-semibold text-foreground dark:text-dark-foreground",children:n.toLocaleString("en-US",{style:"currency",currency:"USD"})}),e.jsx(u,{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${r.isDraft?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:r.isDraft?"Draft":"Finalized"})}),e.jsxs(u,{className:"px-4 py-3 text-center space-x-2",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"text-blue-600 hover:text-blue-800",onClick:()=>$e(r),children:e.jsx(cr,{size:18})}),e.jsx(k,{variant:"ghost",size:"icon",className:"text-green-600 hover:text-green-800",onClick:()=>Je(r),children:e.jsx(ve,{size:18})}),e.jsx(k,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-800",onClick:()=>Re(r),children:e.jsx(ye,{size:18})})]})]},r.orderNumber)}):e.jsx(L,{children:e.jsx(u,{colSpan:6,className:"h-24 text-center text-muted-foreground dark:text-dark-muted-foreground",children:"No purchase orders found for this vendor."})})})]})}),e.jsx(ae,{open:ce||!!c,onOpenChange:r=>{r||(X(!1),f(null),J(null))},children:e.jsxs(ne,{className:"sm:max-w-[1200px] h-[90vh] bg-card dark:bg-dark-card text-foreground dark:text-dark-foreground border-border dark:border-dark-border shadow-2xl rounded-lg",children:[e.jsxs(de,{children:[e.jsx(oe,{className:"text-primary dark:text-dark-primary text-2xl font-semibold",children:c?"Purchase Order Details":p?"Edit Purchase Order":"Create New Purchase Order"}),e.jsx(le,{className:"text-muted-foreground dark:text-dark-muted-foreground",children:c?"Details of the selected purchase order.":p?"Edit the details of the purchase order.":"Fill in the details to create a new purchase order."})]}),c?e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Order Number:"})," ",c.orderNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Supplier:"})," ",O||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Order Date:"})," ",ee(new Date(c.orderDate),"dd-MMM-yyyy")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expected Delivery Date:"})," ",ee(new Date(c.expectedDeliveryDate),"dd-MMM-yyyy")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Memo:"})," ",c.memo||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Shipping Address:"})," ",c.shippingAddress||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Drop Ship To:"})," ",c.dropShipToCustomer&&O||"N/A"]}),e.jsx("h4",{className:"font-semibold mt-4",children:"Line Items:"}),e.jsxs(ue,{children:[e.jsx(he,{children:e.jsxs(L,{children:[e.jsx(N,{children:"Product"}),e.jsx(N,{children:"Quantity"}),e.jsx(N,{children:"Rate"}),e.jsx(N,{children:"Discount"})]})}),e.jsx(xe,{children:c.lineItems.map((r,n)=>e.jsxs(L,{children:[e.jsx(u,{children:r.productName}),e.jsxs(u,{children:[r.quantityInput," ",r.quantityUnitName]}),e.jsxs(u,{children:[r.rateForBillingUnit," per ",r.billingUnitName]}),e.jsx(u,{children:r.discountPercent>0?`${r.discountPercent}%`:r.discountAmount>0?`${r.discountAmount}`:"N/A"})]},n))})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Notes:"})," ",c.notes||"N/A"]})]}):e.jsx(mr,{onSave:Ue,onCancel:()=>{X(!1),J(null)},initialData:p})]})}),e.jsx(Te,{open:me,onOpenChange:s,children:e.jsxs(Ae,{children:[e.jsxs(Ve,{children:[e.jsx(Be,{children:"Are you absolutely sure?"}),e.jsxs(Pe,{children:['This action cannot be undone. This will permanently delete the purchase order "',Q==null?void 0:Q.orderNumber,'".']})]}),e.jsxs(Ie,{children:[e.jsx(k,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsx(k,{variant:"destructive",onClick:He,children:"Yes, delete order"})]})]})})]}),e.jsxs(ge,{value:"notes",children:[e.jsxs("div",{className:"p-4 text-muted-foreground dark:text-dark-muted-foreground",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(k,{onClick:()=>{P(!0),_(null)},children:[e.jsx(ze,{size:18,className:"mr-2"})," Add New Note"]})}),e.jsx("div",{className:"overflow-x-auto border border-border dark:border-dark-border rounded-lg",children:e.jsxs(ue,{children:[e.jsx(he,{className:"bg-muted dark:bg-dark-muted",children:e.jsxs(L,{children:[e.jsx(N,{className:"w-[50px]",children:"Sl No"}),e.jsx(N,{children:"Creation Date"}),e.jsx(N,{children:"Title"}),e.jsx(N,{children:"Description"}),e.jsx(N,{children:"Reminder Time"}),e.jsx(N,{className:"text-center w-[120px]",children:"Action"})]})}),e.jsx(xe,{children:V.length>0?V.map((r,n)=>e.jsxs(L,{className:"hover:bg-muted/50 dark:hover:bg-dark-muted/50",children:[e.jsx(u,{children:n+1}),e.jsx(u,{children:r.creationDate?ee(W(r.creationDate),"dd-MMM-yyyy HH:mm"):"N/A"}),e.jsx(u,{children:r.title}),e.jsx(u,{children:r.description}),e.jsx(u,{children:r.reminderTime?ee(W(r.reminderTime),"dd-MMM-yyyy HH:mm"):"N/A"}),e.jsxs(u,{className:"text-center space-x-1",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>j(r),children:e.jsx(ve,{size:16})}),e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>fe(r.id),children:e.jsx(ye,{size:16})})]})]},r.id)):e.jsx(L,{children:e.jsx(u,{colSpan:6,className:"text-center h-24 text-muted-foreground dark:text-dark-muted-foreground",children:"No notes found for this vendor."})})})]})})]}),e.jsx(ae,{open:Z,onOpenChange:P,children:e.jsxs(ne,{className:"sm:max-w-[425px]",children:[e.jsxs(de,{children:[e.jsx(oe,{children:v?"Edit Note":"Add New Note"}),e.jsx(le,{children:v?"Edit the details of your note.":"Add a new note for this vendor."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(y,{htmlFor:"noteTitle",className:"text-right",children:"Title"}),e.jsx(C,{id:"noteTitle",value:G,onChange:r=>I(r.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(y,{htmlFor:"noteDescription",className:"text-right",children:"Description"}),e.jsx(ke,{id:"noteDescription",value:Y,onChange:r=>$(r.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(y,{htmlFor:"noteReminderTime",className:"text-right",children:"Reminder Time"}),e.jsx(Ne,{date:T,setDate:r=>{r&&r.setHours(10,0,0,0),M(r)},id:"noteReminderTime",className:"col-span-3"})]})]}),e.jsxs(be,{children:[e.jsx(k,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),e.jsx(k,{onClick:b,children:v?"Save Changes":"Add Note"})]})]})})]}),e.jsx(ge,{value:"attachments",children:e.jsx("div",{className:"p-4 text-muted-foreground dark:text-dark-muted-foreground",children:"Attachments content will go here."})})]})]})})},Fe=[{id:"vend-001",name:"Supplier Alpha Inc.",displayName:"Alpha Inc.",proprietorName:"Mr. A",vendorNumber:"V001",address:"123 Supply St",phoneNumber:"555-111-2222",balance:1500,openingBalance:1500,openingBalanceDate:"2023-01-01"},{id:"vend-002",name:"Service Provider Beta",displayName:"Beta Services",proprietorName:"Ms. B",vendorNumber:"V002",address:"456 Service Ave",phoneNumber:"555-333-4444",balance:0,openingBalance:0,openingBalanceDate:"2023-01-01"},{id:"vend-003",name:"Materials Inc.",displayName:"Materials Inc.",proprietorName:"Dr. M",vendorNumber:"V003",address:"789 Material Rd",phoneNumber:"555-555-6666",balance:3250.5,openingBalance:3250.5,openingBalanceDate:"2023-01-01"},{id:"vend-004",name:"Vendor Gamma Co.",displayName:"Gamma Co.",proprietorName:"Prof. G",vendorNumber:"V004",address:"012 Gamma Blvd",phoneNumber:"555-777-8888",balance:-500,openingBalance:-500,openingBalanceDate:"2023-01-01"}],je=d=>({...d,balanceFormatted:parseFloat(d.balance||0).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),te=({children:d,columnKey:O,sortConfig:o,requestSort:h,isTextRight:S=!1,className:x=""})=>{const z=o&&o.key===O,D=z?o.direction:null;return e.jsx("th",{scope:"col",className:`px-4 py-3 cursor-pointer hover:bg-primary/10 dark:hover:bg-dark-primary/10 transition-colors ${S?"text-right":"text-left"} ${x}`,onClick:()=>h(O),children:e.jsxs("div",{className:`flex items-center ${S?"justify-end":"justify-start"}`,children:[!S&&d,e.jsx("span",{className:`mx-1 ${S?"mr-0 ml-1":"ml-0 mr-1"}`,children:z?D==="ascending"?"▲":"▼":e.jsx(hr,{size:14,className:"opacity-40"})}),S&&d]})})},$r=()=>{const{toast:d}=Se();Ke();const[O,o]=t.useState(()=>Fe.map(je)),[h,S]=t.useState(""),[x,z]=t.useState({key:"name",direction:"ascending"}),[D,R]=t.useState(!1),[F,H]=t.useState(null),[U,A]=t.useState(!1),[w,q]=t.useState(null),[l,K]=t.useState(null);t.useEffect(()=>{const a=localStorage.getItem("vendors");a?o(JSON.parse(a).map(je)):localStorage.setItem("vendors",JSON.stringify(Fe))},[]);const V=a=>{localStorage.setItem("vendors",JSON.stringify(a.map(({balanceFormatted:g,...c})=>c)))},B=(a=null)=>{H(a),R(!0)},Z=()=>{R(!1),H(null)},P=(a,g)=>{o(c=>{let f;if(g)f=c.map(p=>p.id===a.id?je({...p,...a,balance:a.openingBalance}):p);else{const p=je({...a,balance:a.openingBalance});f=[...c,p]}return V(f),f})},v=a=>{const g=O.find(c=>c.id===a);g&&(q(g),A(!0))},_=()=>{if(w){const a=O.filter(g=>g.id!==w.id);o(a),V(a),d({title:"Vendor Deleted",description:`${w.name} has been deleted.`,variant:"destructive"}),A(!1),q(null)}},G=a=>{K(a)},I=()=>{K(null)},Y=()=>{d({title:"Import Vendors from Excel",description:"This feature will be available soon.",duration:3e3})},$=a=>S(a.target.value),T=a=>{let g="ascending";x&&x.key===a&&x.direction==="ascending"&&(g="descending"),z({key:a,direction:g})},M=t.useMemo(()=>{let a=[...O];if(h){const g=h.toLowerCase();a=a.filter(c=>{var f;return Object.values(c).some(p=>String(p).toLowerCase().includes(g))||((f=c.displayName)==null?void 0:f.toLowerCase().includes(g))})}return x!==null&&a.sort((g,c)=>{let f=g[x.key],p=c[x.key];return x.key==="balance"?(f=parseFloat(f)||0,p=parseFloat(p)||0):typeof f=="string"&&(f=f.toLowerCase(),p=p.toLowerCase()),f<p?x.direction==="ascending"?-1:1:f>p?x.direction==="ascending"?1:-1:0}),a},[h,x,O]);return e.jsx("div",{className:"space-y-6 p-1",children:e.jsxs(Me,{className:"shadow-lg border-border dark:border-dark-border",children:[e.jsx(dr,{className:"bg-card dark:bg-dark-card rounded-t-lg p-4 md:p-6 border-b border-border dark:border-dark-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsxs(or,{className:"text-2xl md:text-3xl font-bold text-primary dark:text-dark-primary flex items-center",children:[e.jsx(xr,{size:28,className:"mr-3 text-accent dark:text-dark-accent"})," Vendors"]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(Ye,{children:[e.jsx(Qe,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:"text-primary dark:text-dark-primary border-primary dark:border-dark-primary hover:bg-primary/10 dark:hover:bg-dark-primary/10 shadow-sm",children:[e.jsx(ze,{size:20,className:"mr-2"})," Add Vendor"]})}),e.jsxs(Xe,{align:"end",className:"bg-card dark:bg-dark-card shadow-lg rounded-md border border-border dark:border-dark-border",children:[e.jsx(De,{onClick:()=>B(null),className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Add New"}),e.jsx(De,{onClick:Y,className:"text-foreground dark:text-dark-foreground hover:bg-primary/10 dark:hover:bg-dark-primary/10 cursor-pointer",children:"Import from Excel"})]})]})})]})}),e.jsxs(Ee,{className:"p-4 md:p-6",children:[e.jsx(ae,{open:D,onOpenChange:R,children:e.jsxs(ne,{className:"sm:max-w-[550px] bg-card dark:bg-dark-card text-foreground dark:text-dark-foreground border-border dark:border-dark-border shadow-2xl rounded-lg",children:[e.jsxs(de,{children:[e.jsx(oe,{className:"text-primary dark:text-dark-primary text-2xl font-semibold",children:F?"Edit Vendor":"Add New Vendor"}),e.jsx(le,{className:"text-muted-foreground dark:text-dark-muted-foreground",children:F?"Update vendor details.":"Fill in the details to add a new vendor."})]}),e.jsx(pr,{onSave:P,onCancel:Z,initialData:F,isEditMode:!!F})]})}),e.jsx(Te,{open:U,onOpenChange:A,children:e.jsxs(Ae,{children:[e.jsxs(Ve,{children:[e.jsx(Be,{children:"Are you absolutely sure?"}),e.jsxs(Pe,{children:['This action cannot be undone. This will permanently delete the vendor "',w==null?void 0:w.name,'".']})]}),e.jsxs(Ie,{children:[e.jsx(Ze,{onClick:()=>A(!1),children:"Cancel"}),e.jsx(er,{onClick:_,className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete vendor"})]})]})}),l?e.jsx(ae,{open:!!l,onOpenChange:I,children:e.jsxs(ne,{className:"sm:max-w-[90%] h-[90vh] flex flex-col p-0",children:[e.jsxs(de,{className:"p-4 border-b",children:[e.jsx(oe,{className:"text-2xl font-bold",children:"Vendor Ledger"}),e.jsxs(le,{children:["Detailed transaction history for ",l.name]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:e.jsx(gr,{vendorId:l.id,vendorName:l.name,onClose:I,onEditVendor:B})})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 flex items-center space-x-2 p-3 bg-background dark:bg-dark-background rounded-lg shadow-sm border border-border dark:border-dark-border",children:[e.jsx(C,{type:"text",placeholder:"Search vendors (Name, Balance...)",className:"flex-grow focus:ring-accent dark:focus:ring-dark-accent border-input dark:border-dark-input focus:border-primary dark:focus:border-dark-primary",value:h,onChange:$}),e.jsxs(k,{className:"bg-primary text-primary-foreground hover:bg-primary-hover dark:bg-dark-primary dark:text-dark-primary-foreground dark:hover:bg-dark-primary-hover",onClick:()=>d({title:"Search Updated",description:`Displaying results for "${h}"`}),children:[e.jsx(Le,{size:18,className:"mr-2"})," Search"]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border dark:border-dark-border shadow-md",children:e.jsxs("table",{className:"w-full min-w-[600px] text-sm text-left text-foreground dark:text-dark-foreground",children:[e.jsx("thead",{className:"text-xs text-primary dark:text-dark-primary uppercase bg-muted/50 dark:bg-dark-muted/50",children:e.jsxs("tr",{children:[e.jsx(te,{columnKey:"name",sortConfig:x,requestSort:T,className:"min-w-[150px]",children:"Vendor Name"}),e.jsx(te,{columnKey:"displayName",sortConfig:x,requestSort:T,className:"min-w-[150px]",children:"Display Name"}),e.jsx(te,{columnKey:"address",sortConfig:x,requestSort:T,children:"Address"}),e.jsx(te,{columnKey:"phoneNumber",sortConfig:x,requestSort:T,children:"Phone Number"}),e.jsx(te,{columnKey:"balance",sortConfig:x,requestSort:T,isTextRight:!0,children:"Balance"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center w-28",children:"Actions"})]})}),e.jsxs("tbody",{children:[M.map(a=>e.jsxs("tr",{className:"bg-card dark:bg-dark-card border-b border-border dark:border-dark-border last:border-b-0 hover:bg-muted/30 dark:hover:bg-dark-muted/30 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-secondary dark:text-dark-secondary hover:underline cursor-pointer",onClick:()=>G(a),children:a.name}),e.jsx("td",{className:"px-4 py-3",children:a.displayName}),e.jsx("td",{className:"px-4 py-3",children:a.address}),e.jsx("td",{className:"px-4 py-3",children:a.phoneNumber}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold cursor-pointer hover:underline",onClick:()=>G(a),children:a.balanceFormatted}),e.jsxs("td",{className:"px-4 py-3 text-center space-x-1",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"text-secondary dark:text-dark-secondary hover:text-accent dark:hover:text-dark-accent h-8 w-8",onClick:()=>B(a),children:e.jsx(ve,{size:16})}),e.jsx(k,{variant:"ghost",size:"icon",className:"text-destructive dark:text-red-400 hover:text-destructive/80 dark:hover:text-red-300 h-8 w-8",onClick:()=>v(a.id),children:e.jsx(ye,{size:16})})]})]},a.id)),M.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-10 text-muted-foreground dark:text-dark-muted-foreground",children:h?`No vendors found for "${h}".`:"No vendors found. Add your first vendor!"})})]})]})})]})]})]})})};export{$r as default};
