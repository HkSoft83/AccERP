import{r as o,i as N,g as k,j as e,B as n}from"./index-5883662f.js";import{C as D,a as C,b as w,c as v}from"./card-b1098844.js";import{T as E,a as T,b as c,c as a,d as S,e as t}from"./table-00d8f558.js";import{A,a as M,b as z,c as O,d as H,e as P,f as B,g as I}from"./alert-dialog-e937cd20.js";import{P as $}from"./plus-circle-434317f6.js";import{P as F}from"./pen-square-3796a7da.js";import{T as J}from"./trash-2-903ad08e.js";import{f as p}from"./format-f1fedb6d.js";import"./index-9a9b61e0.js";const W=()=>{const[l,m]=o.useState([]),[g,i]=o.useState(!1),[r,x]=o.useState(null),h=N(),{toast:u}=k();o.useEffect(()=>{b()},[]);const b=()=>{const s=JSON.parse(localStorage.getItem("estimates")||"[]");m(s)},j=s=>{const d=l.find(y=>y.id===s);d&&(x(d),i(!0))},f=()=>{if(r){const s=l.filter(d=>d.id!==r.id);localStorage.setItem("estimates",JSON.stringify(s)),m(s),u({title:"Estimate Deleted",description:`Estimate ${r.id} has been deleted.`,variant:"destructive"}),i(!1),x(null)}};return e.jsxs("div",{className:"space-y-6 p-1",children:[e.jsxs(D,{className:"shadow-lg border-border dark:border-dark-border",children:[e.jsx(C,{className:"bg-card dark:bg-dark-card rounded-t-lg p-4 md:p-6 border-b border-border dark:border-dark-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsx(w,{className:"text-2xl md:text-3xl font-bold text-primary dark:text-dark-primary",children:"Estimates"}),e.jsxs(n,{onClick:()=>h("/sales/estimate/new"),className:"bg-primary text-primary-foreground hover:bg-primary-hover dark:bg-dark-primary dark:text-dark-primary-foreground dark:hover:bg-dark-primary-hover",children:[e.jsx($,{size:20,className:"mr-2"})," Create New Estimate"]})]})}),e.jsx(v,{className:"p-4 md:p-6",children:e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border dark:border-dark-border shadow-md",children:e.jsxs(E,{children:[e.jsx(T,{className:"bg-muted/50 dark:bg-dark-muted/50",children:e.jsxs(c,{children:[e.jsx(a,{className:"w-[150px]",children:"Estimate No."}),e.jsx(a,{children:"Customer"}),e.jsx(a,{className:"w-[120px]",children:"Estimate Date"}),e.jsx(a,{className:"w-[120px]",children:"Expiry Date"}),e.jsx(a,{className:"w-[120px] text-right",children:"Total"}),e.jsx(a,{className:"w-[100px]",children:"Status"}),e.jsx(a,{className:"w-[120px] text-center",children:"Actions"})]})}),e.jsx(S,{children:l.length>0?l.map(s=>e.jsxs(c,{className:"hover:bg-muted/50 dark:hover:bg-dark-muted/50",children:[e.jsx(t,{className:"font-medium",children:s.estimateDetails.estimateNumber}),e.jsx(t,{children:s.customer.name}),e.jsx(t,{children:p(new Date(s.estimateDetails.estimateDate),"dd-MMM-yyyy")}),e.jsx(t,{children:p(new Date(s.estimateDetails.expiryDate),"dd-MMM-yyyy")}),e.jsx(t,{className:"text-right font-semibold",children:(s.overallTotal||0).toLocaleString("en-US",{style:"currency",currency:"USD"})}),e.jsx(t,{children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.isDraft?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.isDraft?"Draft":"Finalized"})}),e.jsxs(t,{className:"text-center space-x-1",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>h(`/sales/estimate/${s.id}`),title:"View/Edit",children:e.jsx(F,{size:16})}),e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>j(s.id),title:"Delete",children:e.jsx(J,{size:16})})]})]},s.id)):e.jsx(c,{children:e.jsx(t,{colSpan:7,className:"text-center py-8 text-muted-foreground dark:text-dark-muted-foreground",children:'No estimates found. Click "Create New Estimate" to get started!'})})})]})})})]}),e.jsx(A,{open:g,onOpenChange:i,children:e.jsxs(M,{children:[e.jsxs(z,{children:[e.jsx(O,{children:"Are you absolutely sure?"}),e.jsxs(H,{children:['This action cannot be undone. This will permanently delete estimate "',r==null?void 0:r.id,'".']})]}),e.jsxs(P,{children:[e.jsx(B,{onClick:()=>i(!1),children:"Cancel"}),e.jsx(I,{onClick:f,className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete estimate"})]})]})})]})};export{W as default};
