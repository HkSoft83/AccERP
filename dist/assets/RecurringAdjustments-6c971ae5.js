import{r as n,j as e,N as ce,O as ie,Q as oe,B as E}from"./index-19c11a3b.js";import{C as O,a as Q,b as z,c as _}from"./card-f4a39e41.js";import{L as c}from"./label-02fce936.js";import{I as i}from"./input-f9c35bba.js";import{S as y,a as v,b as g,c as b,d as l}from"./select-25b0f302.js";import{D as G}from"./date-picker-effe6807.js";import"./switch-4ed14315.js";import{m as de}from"./mockAccounts-94c823eb.js";import"./check-3cb4d2e5.js";function ue({value:f,onChange:S}){const[r,N]=n.useState(!1),[o,T]=n.useState("12"),[d,C]=n.useState("00"),[D,F]=n.useState("AM"),w=()=>{S(`${o}:${d} ${D}`),N(!1)};return e.jsxs(ce,{open:r,onOpenChange:N,children:[e.jsx(ie,{asChild:!0,children:e.jsx(i,{type:"text",value:f,readOnly:!0,placeholder:"Select Time"})}),e.jsxs(oe,{className:"w-auto p-0",children:[e.jsxs("div",{className:"flex items-center p-2",children:[e.jsx(i,{type:"number",value:o,onChange:h=>T(h.target.value),min:"1",max:"12",className:"w-16"}),e.jsx("span",{className:"mx-2",children:":"}),e.jsx(i,{type:"number",value:d,onChange:h=>C(h.target.value),min:"0",max:"59",className:"w-16"}),e.jsxs(y,{onValueChange:F,value:D,children:[e.jsx(v,{className:"w-20 ml-2",children:e.jsx(g,{})}),e.jsxs(b,{children:[e.jsx(l,{value:"AM",children:"AM"}),e.jsx(l,{value:"PM",children:"PM"})]})]})]}),e.jsx("div",{className:"p-2 border-t",children:e.jsx(E,{onClick:w,className:"w-full",children:"Set Time"})})]})]})}function fe(){const[f,S]=n.useState(""),[r,N]=n.useState(""),[o,T]=n.useState(null),[d,C]=n.useState(null),[D,F]=n.useState(""),[w,h]=n.useState(""),[M,J]=n.useState(""),[m,R]=n.useState(""),[x,P]=n.useState(""),[U,A]=n.useState(""),[L,$]=n.useState(""),[V,K]=n.useState([]),[u,j]=n.useState([{account:"",debit:"",credit:"",lineNarration:""},{account:"",debit:"",credit:"",lineNarration:""}]),[X,Y]=n.useState(""),[H,Z]=n.useState(0),[W,ee]=n.useState(0);n.useEffect(()=>{ne()},[u]);const k=(s,a,t)=>{const p=[...u];p[s][a]=t,j(p)},se=()=>{j([...u,{account:"",debit:"",credit:"",lineNarration:""}])},te=s=>{const a=u.filter((t,p)=>p!==s);j(a)},ae=s=>{const a=[...u];a[s].credit!==""&&(a[s].credit="",j(a))},re=s=>{const a=[...u];a[s].debit!==""&&(a[s].debit="",j(a))},ne=()=>{let s=0,a=0;u.forEach(t=>{s+=parseFloat(t.debit)||0,a+=parseFloat(t.credit)||0}),Z(s),ee(a)},le=()=>{const s={id:Date.now(),transactionType:f,frequency:r,...r==="custom"&&{customFrequencyValue:m,customFrequencyUnit:x},occurrenceDay:U,occurrenceTime:L,startDate:o?o.toDateString():"",endDate:d?d.toDateString():"",amount:D,description:w,automationType:M};K([...V,s]),S(""),N(""),T(null),C(null),F(""),h(""),J(""),R(""),P(""),A(""),$(""),j([{account:"",debit:"",credit:"",lineNarration:""}]),Y("")};return e.jsxs("div",{className:"p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Recurring Transactions"}),e.jsxs(O,{className:"mb-6",children:[e.jsx(Q,{children:e.jsx(z,{children:"Create New Recurring Transaction"})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"transactionType",children:"Transaction Type"}),e.jsxs(y,{onValueChange:S,value:f,children:[e.jsx(v,{id:"transactionType",children:e.jsx(g,{placeholder:"Select Type"})}),e.jsxs(b,{children:[e.jsx(l,{value:"invoice",children:"Invoice"}),e.jsx(l,{value:"expense",children:"Expense"}),e.jsx(l,{value:"journalEntry",children:"Journal Entry"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"frequency",children:"Frequency"}),e.jsxs(y,{onValueChange:N,value:r,children:[e.jsx(v,{id:"frequency",children:e.jsx(g,{placeholder:"Select Frequency"})}),e.jsxs(b,{children:[e.jsx(l,{value:"daily",children:"Daily"}),e.jsx(l,{value:"weekly",children:"Weekly"}),e.jsx(l,{value:"monthly",children:"Monthly"}),e.jsx(l,{value:"quarterly",children:"Quarterly"}),e.jsx(l,{value:"half-yearly",children:"Half-Yearly"}),e.jsx(l,{value:"annually",children:"Annually"}),e.jsx(l,{value:"custom",children:"Custom"})]})]})]}),r==="custom"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"customFrequencyValue",children:"Every"}),e.jsx(i,{id:"customFrequencyValue",type:"number",value:m,onChange:s=>R(s.target.value),placeholder:"e.g., 2, 3"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"customFrequencyUnit",children:"Unit"}),e.jsxs(y,{onValueChange:P,value:x,children:[e.jsx(v,{id:"customFrequencyUnit",children:e.jsx(g,{placeholder:"Select Unit"})}),e.jsxs(b,{children:[e.jsx(l,{value:"days",children:"Days"}),e.jsx(l,{value:"weeks",children:"Weeks"}),e.jsx(l,{value:"months",children:"Months"}),e.jsx(l,{value:"years",children:"Years"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"startDate",children:"Start Date"}),e.jsx(G,{date:o,setDate:s=>{T(s),d&&s>d&&C(null)}})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"endDate",children:"End Date (Optional)"}),e.jsx(G,{date:d,setDate:C,disabledDate:{before:o}})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"amount",children:"Amount"}),e.jsx(i,{id:"amount",type:"number",value:D,onChange:s=>F(s.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"description",children:"Description"}),e.jsx(i,{id:"description",value:w,onChange:s=>h(s.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"automationType",children:"Automation Type"}),e.jsxs(y,{onValueChange:J,value:M,children:[e.jsx(v,{id:"automationType",children:e.jsx(g,{placeholder:"Select Automation"})}),e.jsxs(b,{children:[e.jsx(l,{value:"scheduled",children:"Scheduled"}),e.jsx(l,{value:"reminder",children:"Reminder"}),e.jsx(l,{value:"unscheduled",children:"Unscheduled"})]})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"occurrenceTime",children:"Time of Day"}),e.jsx(ue,{value:L,onChange:$})]}),(r==="weekly"||r==="monthly"||r==="quarterly"||r==="half-yearly"||r==="annually"||r==="custom")&&e.jsxs("div",{children:[e.jsxs(c,{htmlFor:"occurrenceDay",children:["Day of ",r==="weekly"?"Week":r==="monthly"?"Month":r==="annually"?"Year":"Period"]}),e.jsx(i,{id:"occurrenceDay",type:"text",value:U,onChange:s=>{const a=s.target.value;let t;switch(r){case"weekly":t=7;break;case"monthly":t=31;break;case"quarterly":t=92;break;case"half-yearly":t=183;break;case"annually":t=365;break;case"custom":x==="days"?t=parseInt(m)||1:x==="weeks"?t=(parseInt(m)||1)*7:x==="months"?t=(parseInt(m)||1)*new Date(o.getFullYear(),o.getMonth()+1,0).getDate():x==="years"&&(t=(parseInt(m)||1)*365);break;default:t=1/0}const p=a.split(/[,/]/).map(q=>q.trim());let B=!0;if(a===""){A("");return}for(const q of p){if(q.toLowerCase()==="last")continue;const I=parseInt(q);if(isNaN(I)||I<1||I>t){B=!1;break}}B&&A(a)},placeholder:r==="weekly"?"e.g., 1 (Mon), 7 (Sun)":r==="monthly"?"e.g., 1, 15, last":r==="quarterly"||r==="half-yearly"||r==="annually"?"e.g., 1, 90, 180, last":"e.g., 1, 4, last"})]})]})]}),f==="journalEntry"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Journal Entry Details"}),e.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b",children:"Account"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Debit"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Credit"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Line Narration"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),e.jsx("tbody",{children:u.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsxs(y,{onValueChange:t=>k(a,"account",t),value:s.account,children:[e.jsx(v,{children:e.jsx(g,{placeholder:"Select Account"})}),e.jsx(b,{children:de.map(t=>e.jsx(l,{value:t.name,children:t.name},t.id))})]})}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsx(i,{type:"number",value:s.debit,onChange:t=>k(a,"debit",t.target.value),onFocus:()=>ae(a),className:"w-full"})}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsx(i,{type:"number",value:s.credit,onChange:t=>k(a,"credit",t.target.value),onFocus:()=>re(a),className:"w-full"})}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsx(i,{type:"text",value:s.lineNarration,onChange:t=>k(a,"lineNarration",t.target.value),className:"w-full"})}),e.jsx("td",{className:"py-2 px-4 border-b text-center",children:e.jsx(E,{variant:"destructive",size:"sm",onClick:()=>te(a),children:"Remove"})})]},a))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 font-bold text-right",children:"Total:"}),e.jsx("td",{className:"py-2 px-4 font-bold",children:H.toFixed(2)}),e.jsx("td",{className:"py-2 px-4 font-bold",children:W.toFixed(2)}),e.jsx("td",{colSpan:"2"})]})})]}),e.jsx(E,{onClick:se,className:"mt-2",children:"Add Line Item"}),H!==W&&e.jsx("p",{className:"text-red-500 mt-2",children:"Debit and Credit totals must be equal!"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(c,{htmlFor:"overallNarration",children:"Overall Narration"}),e.jsx(i,{id:"overallNarration",type:"text",value:X,onChange:s=>Y(s.target.value),className:"w-full"})]})]}),e.jsx(E,{onClick:le,children:"Add Recurring Transaction"})]})]}),e.jsxs(O,{children:[e.jsx(Q,{children:e.jsx(z,{children:"Existing Recurring Transactions"})}),e.jsx(_,{children:V.length===0?e.jsx("p",{children:"No recurring transactions added yet."}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:V.map(s=>e.jsxs(O,{className:"p-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.transactionType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Frequency:"})," ",s.frequency," ",s.frequency==="custom"&&`(Every ${s.customFrequencyValue} ${s.customFrequencyUnit})`]}),s.occurrenceDay&&e.jsxs("p",{children:[e.jsx("strong",{children:"Occurs On:"})," ",s.occurrenceDay]}),s.occurrenceTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"At Time:"})," ",s.occurrenceTime]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Start Date:"})," ",s.startDate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"End Date:"})," ",s.endDate||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," ",s.amount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",s.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Automation:"})," ",s.automationType]})]},s.id))})})]})]})}export{fe as default};
